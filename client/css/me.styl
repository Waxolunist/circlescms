@import "normalize"
@import "mixin"
@import "960"
@import "animations"

background-color = #e5e9ea
header-color = #657089
orange = #D15600
green = #73880A
blue =  #3F4C6B
red = #D01F3C
circle-colors = orange green blue red
circlecount = length(circle-colors)

/* colmargins are defined in 960 */
nav-overlap = colmargin-right + colmargin-left
nav-circlesize = 3 * colwidth + 2 * nav-overlap
nav-containersize = nav-circlesize * circlecount - colmargin-left * (circlecount - 1) 
nav-tabheight = 35px
nav-fontsize = 170%
nav-activeborder = 5px
nav-paddingbottom = 100px

/* medias */
medium = '(max-width:' + (nav-containersize + 20px) + ')'

body 
  background background-color url(/images/bg.png)
  font-family 'Ubuntu', sans-serif
  position relative

.container_12
  width nav-containersize
  min-width nav-containersize
  & .grid_12
    width 100%
    margin-left 0
    margin-right 0

header
  font-family 'Permanent Marker', cursive
  margin-top 1.5em
  margin-bottom 1em
  > hgroup
    > h1
      color header-color
    > h2
      color lighten(header-color, 30)
    > h1
    > h2
      // webkit fix
      margin-before 0
      margin-after 0

/* circles container */
nav
  // active state
  transition-delay 0.1s 
  transition-property none
  &.active
    & .grid_3
      width (nav-containersize / 4)
    > a
      border-radius 0        
      height nav-tabheight
      line-height nav-tabheight
      margin-right 0
      &.overlap
        /* remove overlap when active*/
        margin-left 0
      &.active
        border-bottom nav-activeborder black solid
      &::after 
        content normal // disable ::after

  // inactive state
  > a
    font-size nav-fontsize
    color white
    text-align center
    text-transform lowercase
    text-decoration none // links are underlined by default
    line-height nav-circlesize
    full-circle nav-circlesize
    opacity .8
    for row in 1..circlecount
      &:nth-child({row})
        z-index circlecount + 1 - row
        background-color circle-colors[row - 1]
    transition-property height,border-radius,line-height
    &:hover
      z-index circlecount + 1
    &.overlap
      margin-left nav-overlap * -1
      &.alpha
        margin-left 0

    &::after
      content ""
      height 100%
      width 100%
      position absolute
      top 0
      left 0
      background-image url(/images/hover-circle.png)
      background-repeat no-repeat
      background-size 100%
    &:hover::after
      animation rotateIn 2s linear

div.topbar
  height 1.2em
  position absolute
  top 0
  right 0
  font-size small
  border-bottom 1px lighten(header-color, 30) solid
  > a
    padding-right 1em
    color lighten(header-color, 30)
    text-decoration none
    &.omega
      padding-right 0

footer
  padding-bottom 5em
  border-top 1px black solid

/* TODO */
article
  height auto
  max-height 0px
  overflow hidden
  opacity 0
  transition-property opacity,max-height
  &.active
    max-height 1500px
    background-color white
    opacity 1
  &#content
    padding-left 1em
    padding-right 1em
    line-height 3.4ex
    calculate width, "100% - 2em"

.animated
  transition-duration 1s
  transition-timing-function ease
  transition-delay 0s 

ol.blog
  padding-start 0
  list-style-type none 
  & li
    line-height 3em
    border-bottom 1px lighten(#757575, 40) solid
    &:hover
      background-color lighten(#757575, 45)
  & time
    color #757575 
    text-transform uppercase
  & a
    text-decoration none
    overflow hidden
    text-overflow ellipsis
    white-space nowrap
    word-wrap normal

@media medium 
  @css {
    @viewport {
      width: device-width;
      zoom: 1;
    }
  }

  // iphone 4
  html
    calculate height, "100% + 100px"

  .container_12
  .container_12 .grid_12
    width nav-circlesize * 2 - colmargin-right
    min-width nav-circlesize * 2 - colmargin-right
  
  div.topbar
    font-size medium
  
  header
    margin-top 0.7em
    > hgroup
      > h1
        font-size 1.45em
      > h2
        font-size 1.1em

  nav
    height nav-circlesize * 2 - colmargin-right
    > a
      &::after
        animation rotateIn 2s linear
      &:nth-child(2)
        margin-right 0
      &:nth-child(3)
        margin-left 0
        margin-top (colmargin-right * -1)
      &:nth-child(4)
        margin-top (colmargin-right * -1)
      &:hover::after
        animation none
    &.grid_12.active
      transition-property height
      transition-delay 0.1s 
      height nav-tabheight * 2 + nav-activeborder
      > a
        width ((nav-circlesize * 2 - colmargin-right) / 2)
        margin-top 0
        &.active
          &:nth-child(1)
          &:nth-child(2)
            border-bottom none
            border-top nav-activeborder black solid
            margin-top (nav-activeborder * -1)
